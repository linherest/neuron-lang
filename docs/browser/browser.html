<!DOCTYPE html>
<html>
  <head>
    <meta charset = "UTF-8">
    <title>Neuron Compiler</title>
    <meta name = "description" content = "Neuron Compiler">
    <link href = "https://fonts.googleapis.com/css2?family=Montserrat:wght@300&display=swap" rel = "stylesheet">
    <style>
      body {
        margin: 0;
        font-family: monospace;
        background: #1A1A1A;
        overflow: hidden;
      }
      
      .code {
        width: 100%;
        height: 100%;
      }
      
      h3 {
        font-family: "Montserrat";
        font-size: 1em;
        padding: 1em;
        margin: 1vh;
        color: gray;
        letter-spacing: 10px;
        border-bottom: 1px solid currentcolor;
      }
      
      pre {
        font-size: 1em;
        padding: 1em;
        margin: 1vh;
        background: #262626;
        letter-spacing: 1px;
        color: darkorange;
        width: 100%;
        height: 100%;
      }
      
      .entity.name.function {
        color: darkorange;
      }
      
      .entity.name.type {
        color: gray;
      }
    </style>
  </head>
  <body>
    <div class = "code">
      <h3>NEURON</h3>
      <div>
        <pre id = "code" contenteditable = "true">=></pre>
      </div>
    </div>
    <div class = "sidebar">
    </div>
    <script type = "module">
      var grammers = JSON.parse(`{
        "scopeName": "source.neuron",
        "name": "Neuron",
        "fileTypes": [
          ".neuron"
        ],
        "patterns": [
          {
            "match": "\/\/.*$",
            "name": "comment"
          },
          {
            "match": "\w+(?=\s*?\{)",
            "name": "entity.name.function"
          },
          {
            "match": "\w+(?=\s*?\()",
            "name": "entity.name.function"
          },
          {
            "match": "\=\>",
            "name": "entity.name.function"
          },
          {
            "match": "^(?=\:)",
            "name": "entity.name.type"
          },
          {
            "match": "[0-9]",
            "name": "constant.numeric"
          },
          {
            "match": "#\S+",
            "name": "entity.name.type"
          },
          {
            "match": "\w+(?=\.)",
            "name": "entity.name.type"
          },
          {
            "match": "=",
            "name": "keyword.operator"
          },
          {
            "match": "return|value",
            "name": "keyword.control"
          },
          {
            "match": "true|false|null",
            "name": "constant.language"
          },
          {
            "match": "this",
            "name": "variable.language"
          }
        ]
      }`);
      var code = document.getElementById("code");
      var text = code.innerHTML;
      var matches = [];
      for (var i in grammers.patterns) {
        var re = grammers.patterns[i].match;
        var str = code.innerHTML;
        while ((match = re.exec(str)) != null) {
          matches.push([match.index, re.lastIndex, grammers.patterns[i].name]);
        }
      }
      for (var i in matches) {
        highlight(code, matches[i][0], matches[i][1], matches[i][2]);
      }
      
      function highlight(element, start, end, cl) {
        var str = element.innerHTML;
        str = `${str.substr(0, start)}<span class = "${cl}">${str.substr(start, end - start + 1)}</span>${str.substr(end + 1)}`;
        element.innerHTML = str;
      }
    </script>
  </body>
</html>
